"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e19ecdf9-4ac5-57cf-80e7-b2c32abd52c8")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[5934],{589337:(e,t,a)=>{a.d(t,{F:()=>i,HR:()=>c,Io:()=>s,Ok:()=>r,Pn:()=>_,V_:()=>o,dK:()=>u,nM:()=>d,rH:()=>n,sQ:()=>l,ue:()=>p});let o="on_canvas_pill--pillContainer--jvRgr",i="on_canvas_pill--centered--iOUXI",s="on_canvas_pill--pill--fSukI",l="on_canvas_pill--bottom--gwvqA",n="on_canvas_pill--node--xgavI",c="on_canvas_pill--symbol--3Kz9f",r="on_canvas_pill--forceBrandColor--DynJg",d="on_canvas_pill--row--I6QoB",_="on_canvas_pill--pillLargeBorderRadius--9uWP9",u="on_canvas_pill--pillText--ts0Xi ellipsis--ellipsis--Tjyfa",p="on_canvas_pill--iconNodeType--0xm99"},832067:(e,t,a)=>{a.d(t,{N:()=>n,S:()=>c});var o=a(716976),i=a(795033);let s=(0,i.eU)(0),l=(0,i.eU)(e=>e(s)>0);function n({isVisible:e}){let t=(0,i.Xr)(s);(0,o.useLayoutEffect)(()=>{if(e)return t(e=>e+1),()=>t(e=>Math.max(0,e-1))},[e,t])}function c(){return(0,i.md)(l)}},714714:(e,t,a)=>{a.d(t,{MO:()=>x,Tq:()=>b});var o=a(104076),i=a(716976),s=a(681958),l=a(324063),n=a(511570),c=a.n(n),r=a(652539),d=a(278491),_=a(692042),u=a(271899),p=a(589337),v=a(108557),h=a(253654),m=a(839808),E=a(564837),f=a(60943),N=a(559949),I=a(372209),g=a(253373),O=a(160761),w=a(939968);let x=i.forwardRef(function(e,t){let{boundingBox:a,isFigmaPurple:i}=e.node,s=function(e,t,a,o){let i=(0,_._X)({subscribeToUpdates_expensive:!0});if(!i)return null;let s={},l=(0,_.Yb)(i,{x:e.x,y:e.y,width:e.w,height:e.h});return s.left=l.x+i.x,s.top=l.y+i.y,t&&(s.left+=l.width/2),a&&(s.top=l.y+i.y+l.height),{containerStyle:s,pillStyle:o&&{maxWidth:o(l.width)},zoomScale:i.zoomScale}}(a,e.centered,e.bottom,e.maxWidth);if(!s)return null;let{containerStyle:l,pillStyle:n}=s;return(0,o.jsx)("div",{ref:t,className:c()(d.Dm,p.V_,{[p.F]:e.centered,[p.sQ]:e.bottom}),style:{...l,marginLeft:e.offsetX??0,marginTop:e.offsetY?.(s.zoomScale)??0},"data-testid":e.dataTestId,children:(0,o.jsx)("div",{className:c()(p.Io,i?p.HR:p.rH,e.largeBorderRadius&&p.Pn,e.forceBrandColor&&p.Ok),style:n,children:e.children})})});function b({node:e}){let t=(0,l.xx)((e,t)=>(0,u.D)(e,t)),a=e?t(e.guid,e.objectsPanelThumbnailId):"",i=a?(0,r.V)(a):function(e){let t=null;switch(e.type){case"TEXT":t=O.A;break;case"FRAME":t=e.isGroup?h.A:e.isStateGroup?I.A:(0,u.GN)({stackMode:e.stackMode,stackCounterAlignItems:e.stackCounterAlignItems});break;case"ROUNDED_RECTANGLE":t=f.A;break;case"ELLIPSE":t=v.A;break;case"STAR":t=N.A;break;case"VECTOR":t=w.A;break;case"GROUP":t=h.A;break;case"INSTANCE":t=m.A;break;case"SYMBOL":t=e.isState?g.A:I.A}return(0,s.oY)(e.type)&&e.hasEnabledStaticImagePaint&&(t=E.A),t}(e);return i?(0,o.jsx)(r.B,{className:p.ue,svg:i}):null}},7221:(e,t,a)=>{a.d(t,{s:()=>th});var o=a(104076),i=a(716976),s=a(237420),l=a(377692),n=a(211862),c=a(592726),r=a(779574),d=a(286132),_=a(305651),u=a(689161),p=a(375266),v=a(511570),h=a.n(v),m=a(681398),E=a(192075),f=a(74620),N=a(459496),I=a(832067),g=a(349311),O=a(122010),w=a(737139),x=a(49875),b=a(623355);let j="voice_widget--modal--xsQ2A",T="voice_widget--show--O6ORx voice_widget--modal--xsQ2A",R="voice_widget--topRow--O1wj-",D="voice_widget--voiceModalPanel--KD-J1";function C(e){let{fileKey:t}=e;var{userIdsInCall:a}=(0,d.W5)(t);let s=a.size,l=(0,f.aV)(),n=(0,c.iZ)();i.useEffect(()=>{!m.XN&&n?.id&&!a.has(n.id)&&(0,N.w$)(s)},[s,n?.id,a]);let r=!l&&!m.XN;return((0,I.N)({isVisible:r}),r)?(0,o.jsx)("div",{className:h()(j,T),children:(0,o.jsx)(u.T,{children:(0,o.jsx)(O.m,{role:"region",children:(0,o.jsx)(w.Id,{className:D,children:(0,o.jsxs)("div",{className:R,children:[(0,o.jsxs)("div",{className:"voice_widget--joinModalCountGroup--zxI6Q","aria-label":(0,E.t)("collaboration.voice.num_users_in_call",{numUsers:a.size}),role:"img",children:[(0,o.jsx)(p.M,{className:b.QH}),a.size]}),(0,o.jsx)(x.K,{fileKey:e.fileKey,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.join_conversation"),isJoinWidget:!0,"data-onboarding-key":"audio-nux-key",children:(0,E.tx)("collaboration.voice.join")})]})})})})}):(0,o.jsx)(o.Fragment,{})}var A=a(492737),y=a(454851),k=a(684742),S=a(417167),L=a(755444),W=a(134873),U=a(432099),P=a(147046),M=a(366535),$=a(249586),G=a(11033),B=a(40452),V=a(765846),H=a(826160),F=a(523783),z=a(4921),J=a(374765),X=a(856909),Y=a(652539),K=a(111679),q=a(506192),Q=a(346886),Z=a(87535);let ee="captions_dialog--showGradient--ZAHRk";var et=a(789982);let ea="DROPDOWN_TYPE_CAPTIONS_DIALOG_TYPE_SIZE";function eo({caption:e,user:t}){let a=e.userId+"_"+e.timestamp;return(0,o.jsxs)("div",{className:"captions_dialog--captionRow--pgS-N",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(H.Ro,{className:"captions_dialog--avatar--ISexR",entity:{...t,id:e.userId},size:24}),(0,o.jsx)("div",{className:"captions_dialog--name--SmWv6",children:t?t.name:e.userId})]}),e.text.map((e,t)=>(0,o.jsx)("div",{className:"captions_dialog--paragraph--SjDQd",children:e.map((e,i)=>(0,o.jsx)("div",{className:"captions_dialog--sentence--SJkHn",children:`${e} `},a+"_"+t+"_"+i))},a+"_"+t))]},a)}let ei=()=>({small:{style:"captions_dialog--smallText--aUeBx",label:(0,E.t)("collaboration.voice.small")},medium:{style:"captions_dialog--mediumText--ODxEN",label:(0,E.t)("collaboration.voice.medium")},large:{style:"captions_dialog--largeText---t1d2",label:(0,E.t)("collaboration.voice.large")},x_large:{style:"captions_dialog--xlargeText--C60DA",label:(0,E.t)("collaboration.voice.x_large")}}),es=Date.now();function el({call:e}){let t=ei(),[a,l]=i.useState([]),[c,r]=i.useState(t.small.style),[_,u]=i.useState(!1),[p,v]=i.useState(!1),[h,m]=i.useState(!1),f=(0,n.q5)();if(!f)throw Error("Open file required");let N=(0,s.d4)(e=>e.voice.activeCall[f.key]),I=(0,s.wA)(),[O,w]=i.useState(null),x=(0,q.Um)(),b=i.useRef(null),j=!!(x&&x.type===ea),T=a.reduce((e,t)=>e.add(t.userId),new Set),R=(0,d.bF)(T,f.key).reduce((e,t)=>(e[t.userID]=t,e),{});i.useEffect(()=>{let t=e=>{e&&l(e)};return e.audioCaptionStream.subscribe(t),()=>e.audioCaptionStream.unsubscribe(t)}),i.useEffect(()=>{O&&O.scrollHeight-O.scrollTop-O.clientHeight<150&&es<Date.now()-150&&O.scrollTo({top:O.scrollHeight-O.clientHeight,behavior:"smooth"})}),i.useEffect(()=>{O&&!h&&(O.scrollTop=O.scrollHeight-O.clientHeight)},[O,h]);let D=!h&&N;return(0,o.jsxs)("div",{className:["captions_dialog--captionsDialog--gOIvh",c].join(" "),children:[(0,o.jsx)("div",{className:["captions_dialog--topDivider--BlM0x captions_dialog--_divider--m8Skg",_?ee:""].join(" ")}),D&&(0,o.jsx)("div",{className:"captions_dialog--scrollContainer--WuVOJ",ref:e=>w(e),onScroll:e=>{O&&(v(0!=O.scrollHeight-O.scrollTop-O.clientHeight),u(0!==O.scrollTop))},onWheel:e=>{e.deltaY<0&&(es=Date.now())},children:(0,o.jsx)("div",{className:"captions_dialog--scrollContainerInner--db2cV",children:a.map(e=>(0,o.jsx)(eo,{caption:e,user:R[e.userId]},e.timestamp))})}),D&&(0,o.jsx)("div",{className:["captions_dialog--bottomDivider--WBbo5 captions_dialog--_divider--m8Skg",p?ee:""].join(" ")}),D&&(0,o.jsx)(k.E,{onClick:()=>O.scrollTo({top:O.scrollHeight-O.clientHeight,behavior:"smooth"}),className:`captions_dialog--scrollToBottomButton--SeU-4 ${p?"captions_dialog--showScrollToBottomButton--Lc7Iy":""}`,children:(0,E.tx)("collaboration.voice.new_transcripts")}),(0,o.jsxs)("div",{className:"captions_dialog--header--SA3Wv",children:[(0,o.jsxs)("div",{className:"captions_dialog--captionToggleGroup--osEtj",onClick:()=>m(!h),children:[(0,o.jsx)(z.f,{checked:h,onIcon:(0,o.jsx)(Y.B,{className:"captions_dialog--closedCaptionsIconMaximized--N-lwT",svg:et.A}),offIcon:(0,o.jsx)(Y.B,{className:"captions_dialog--closedCaptionsIconMinimized--Ou0WE",svg:et.A}),"aria-label":(0,E.t)("collaboration.voice.closed_captions"),onChange:()=>m(!h)}),(0,o.jsx)("span",{children:(0,E.tx)("collaboration.voice.closed_captions")}),(0,o.jsx)(X.Ex,{text:(0,E.t)("collaboration.voice.beta"),color:X.zE.BRAND})]}),(0,o.jsx)(Z.K0,{ref:b,className:"captions_dialog--typeSizeIcon--Xhxj-",onClick:e=>{e.stopPropagation(),I(K.gR({type:ea}))},"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.text_size"),children:(0,o.jsx)(J.Z,{})}),b.current&&j&&(0,o.jsx)(Q.j,{dispatch:I,items:Object.keys(t).map(e=>({name:e,displayText:t[e].label,className:[t[e].style,"captions_dialog--dropdownTextOptions--ma0Ue"].join(" "),isChecked:t[e].style===c})),showPoint:!0,parentRect:b.current?.getBoundingClientRect(),onSelectItem:e=>{e.name&&r(t[e.name].style)},minWidth:96}),(0,o.jsx)("div",{style:{clear:"both"}})]})]})}var en=a(316427),ec=a(437481),er=a(633065),ed=a(792875),e_=a(180610);let eu=[_.$E.WARNING_RECV_AUDIO_DECODE_FAILED,_.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW,_.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW,_.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW];function ep(e){let t;if((0,ed.Im)(e.activeWarnings))return null;for(let a of eu)if(e.activeWarnings[a]){t=e.activeWarnings[a];break}return t?(0,o.jsx)("div",{className:e.className,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":t,"data-tooltip-show-below":!0,"data-tooltip-timeout-delay":50,children:(0,o.jsx)(e_.n,{className:"voice_warning_icon--icon--NvhIw","aria-label":t})}):null}function ev(e){switch(e){case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:return(0,E.t)("collaboration.voice.audio_input_too_low_warning");case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:return(0,E.t)("collaboration.voice.speaker_volume_too_low_warning");case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:return(0,E.t)("collaboration.voice.poor_connection_warning");default:return null}}function eh(e){let{callEvent:t,onClick:a,notificationUserId:l}=e.notification,[n,c]=i.useState(null),[d,u]=i.useState(!1),p=i.useRef(),v=i.useRef(t),[h,m]=i.useState(),f=(0,s.d4)(e=>e.multiplayer.allUsers),N=(0,s.d4)(e=>e.voice.voiceUsersById),I=i.useMemo(()=>{if(l){if(l in N)return N[l].name;let e=f.find(e=>e.userID===l);if(e)return e.name}return"User"},[l,N,f]),g=h?.href,O=i.useMemo(()=>g?"a":"div",[g]);if(i.useEffect(()=>()=>{p?.current&&clearTimeout(p.current)},[]),i.useEffect(()=>{let e=()=>{u(!1),c(null)};h?(u(!0),c(null),h.persist||c(setTimeout(()=>{e()},2e3))):e()},[h]),i.useEffect(()=>()=>{n&&clearTimeout(n)},[n]),i.useEffect(()=>{switch(v.current=t,t){case _.$E.CONNECTED:m({msg:(0,E.t)("collaboration.voice.connected"),type:_.w.SUCCESS,icon:(0,o.jsx)(ec.g,{})});break;case _.$E.CONNECTED_WITH_MIC_DISABLED:m({msg:(0,E.t)("collaboration.voice.connected_check_your_microphone_permissions_to_start_chatting"),allowMultiLine:!0,type:_.w.SUCCESS});break;case _.$E.CONNECTING:m({msg:(0,E.t)("collaboration.voice.connecting"),type:_.w.PENDING,persist:!0});break;case _.$E.ERROR:m({msg:(0,E.t)("collaboration.voice.something_went_wrong_try_again"),type:_.w.ERROR,persist:!0});break;case _.$E.CALL_INACTIVE:m({msg:(0,E.t)("collaboration.voice.things_got_quiet_for_awhile_so_we_ended_the_conversation"),type:_.w.PENDING,persist:!1,allowMultiLine:!0});break;case _.$E.TOKEN_WILL_EXPIRE:m({msg:(0,E.t)("collaboration.voice.it_s_been_quiet_for_a_while_so_we_ll_end_the_conversation_in_20_seconds_n_click_to_stay_on"),type:_.w.MESSAGE,persist:!0,onClick:a,allowMultiLine:!0});break;case _.$E.TOKEN_EXPIRED:m({msg:(0,E.t)("collaboration.voice.audio_has_timed_out_click_to_rejoin"),type:_.w.ERROR,persist:!0,onClick:a});break;case _.$E.USER_JOINED:m({truncatedPrefix:I,msg:(0,E.t)("collaboration.voice.joined"),type:_.w.MESSAGE});break;case _.$E.USER_LEFT:m({truncatedPrefix:I,msg:(0,E.t)("collaboration.voice.left"),type:_.w.MESSAGE});break;case _.$E.ERROR_MICROPHONE_PERMISSIONS_DENIED:let e=(0,E.t)("collaboration.voice.enable_mic_access_in_your_browser_to_join");er.eD&&(e=(0,E.t)("collaboration.voice.enable_mic_access_for_the_figma_app_to_join")),m({msg:e,type:_.w.ERROR,href:r.AM.TROUBLESHOOT});break;case _.$E.WARNING_MICROPHONE_LEVELS_HIGH_AND_MUTED:m({msg:(0,E.t)("collaboration.voice.want_to_unmute_click_the_mic"),type:_.w.PENDING});break;case _.$E.ERROR_ON_LEAVE:m({msg:(0,E.t)("collaboration.voice.couldn_t_leave_please_try_again"),type:_.w.ERROR});break;case _.$E.SYSTEM_INCOMPATIBLE:m({msg:(0,E.t)("collaboration.voice.figma_audio_won_t_work_on_your_device_learn_why"),type:_.w.ERROR,persist:!0,allowMultiLine:!0,href:r.AM.TROUBLESHOOT});break;case _.$E.DISCONNECTING:case _.$E.RECONNECTING:p.current=setTimeout(()=>{v.current===_.$E.RECONNECTING&&(m({msg:(0,E.t)("collaboration.voice.attempting_to_reconnect"),type:_.w.PENDING,persist:!0}),p.current=void 0)},1500);break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:let i=ev(t);if(!i)break;m({msg:i,type:_.w.WARNING,allowMultiLine:!0})}},[t]),void 0===t)return(0,o.jsx)(o.Fragment,{});let x=["expanded"===e.widgetState?"voice_flash_notifications--flashExpandedList--NkNnw voice_flash_notifications--flash--8i3SH":"voice_flash_notifications--flash--8i3SH",d?function(){switch(h?.type){case _.w.ERROR:return"voice_flash_notifications--flashError--6fLPW";case _.w.WARNING:return"voice_flash_notifications--flashWarning--tdCit";case _.w.MESSAGE:return"voice_flash_notifications--flashMessage--lt-k-";case _.w.SUCCESS:return"voice_flash_notifications--flashSuccess--hmpUM";case _.w.PENDING:default:return"voice_flash_notifications--flashPending--Hzt7W"}}():"voice_flash_notifications--flashHidden--uYI96"];return(0,o.jsx)(w.kg,{onClick:h?.onClick,className:x.join(" "),children:(0,o.jsxs)(O,{className:"voice_flash_notifications--flashNotificationMessageWrap--eXghM voice_flash_notifications--flashNotificationMessageBase--wxFPN",target:"_blank",rel:"noopener",href:h?.href,children:[h?.truncatedPrefix&&(0,o.jsx)("span",{className:"voice_flash_notifications--truncatedPrefix---gMQI ellipsis--ellipsis--Tjyfa",children:h?.truncatedPrefix}),h?.icon,h?.msg]})})}var em=a(390036),eE=a(849757),ef=a(228439),eN=a(286911),eI=a(55557),eg=a(828127);let eO="active_speakers_row--name--LtwVz ellipsis--ellipsis--Tjyfa",ew="active_speakers_row--pos1--88uza active_speakers_row--pos--D59NJ",ex="active_speakers_row--fadeOut--2tZhG",eb="active_speakers_row--willFadeIn--fFCX6",ej="active_speakers_row--activeSpeakerRowAvatar--zKOXb",eT=(e,t)=>e.userID===t.userID,eR=(e,t)=>{let a=e.sort((e,t)=>e.userID>t.userID?-1:1).map(e=>e.userID),o=t.sort((e,t)=>e.userID>t.userID?-1:1).map(e=>e.userID);if(a.length!==o.length)return!0;for(let e=0;e<a.length;e++)if(a[e]!==o[e])return!0;return!1},eD=(e,t)=>{let a=t.filter(t=>!e.find(e=>eT(e,t))),o=e.filter(e=>!t.find(t=>eT(e,t))),i=e.map(e=>o.indexOf(e)>-1?e:void 0),s=e.map(e=>-1===o.indexOf(e)?e:a.shift()).filter(e=>!!e);return a.length>0&&s.push(...a),t.length>1&&1===e.length&&(i[1]=e[0]),{fadeOut:i,active:s}};function eC({user:e,classNames:t,call:a}){let i;let l=(0,s.d4)(e=>e.multiplayer.observingSessionID),n=(0,s.d4)(e=>e.multiplayer.presenterSessionID??null),c=(Array.isArray(t)?[...t,ej]:[t,ej]).join(" "),d=(0,r.eo)(),u=(0,o.jsx)(H.Ro,{entity:{...e,id:e.userID},className:"active_speakers_row--activeSpeakerRowAvatarWithoutMultiplayer--W-S0A",size:24},e.userID),p=e=>{e.stopPropagation()};return"sessionID"in e&&(i=`active-speaker-row-voice-avatar-session-${e.sessionID}`,u=(0,o.jsx)(eN.vQ,{sessionID:e?.sessionID,observingSessionID:l,presenterSessionID:n??null,nominatedSessionID:null,user:e,showColorIndicators:!0,tooltipProxyId:i}),p=t=>{t.stopPropagation(),t.preventDefault(),d(e)}),(0,o.jsxs)("div",{className:c,children:[(0,o.jsx)("div",{className:"active_speakers_row--avatarObserveClickTarget--T1JH- voice_toolbar--avatarObserveClickTarget--QALFw",onClick:p,"data-tooltip-proxy-element-id":i}),u,(0,o.jsx)(eg.i,{userId:e.userID,userName:e.name,microphoneStyle:_.bU.FULL,call:a,volumeIconMutedState:eg.S.MINI,className:"active_speakers_row--voiceIndicatorPositioning--YqGFz"})]})}function eA({user:e,classNames:t}){return(0,o.jsx)("div",{className:eO+" "+(Array.isArray(t)?t.join(" "):t),children:e.name})}let ey=["active_speakers_row--pos0--Dc1bB active_speakers_row--pos--D59NJ",ew,"active_speakers_row--pos2--b5pkb active_speakers_row--pos--D59NJ","active_speakers_row--pos3--EAAkN active_speakers_row--pos--D59NJ","active_speakers_row--pos4--R5-5y active_speakers_row--pos--D59NJ","active_speakers_row--pos5--FYPvT active_speakers_row--pos--D59NJ","active_speakers_row--pos6--PTsn8 active_speakers_row--pos--D59NJ","active_speakers_row--pos7--DjtPj active_speakers_row--pos--D59NJ"];class ek extends i.Component{constructor(e){super(e),this.displayString="ActiveSpeakersRow",this.node=null,this.state={active:[],fadeOut:[]}}componentWillMount(){this.setState(eD(this.state.active,this.props.users))}shouldComponentUpdate(e,t){return e===this.props||(eR(this.props.users,e.users)&&this.setState(eD(this.state.active,e.users)),!1)}render(){let e=(e,t)=>`${e.name}-${t}`,t=[],a=eI.h.getInstance();if(!a)return null;if(1===this.state.fadeOut.length&&this.state.fadeOut[0]){let i=this.state.fadeOut[0];t.push((0,o.jsx)(eC,{call:a,user:i,classNames:[ey[0],ex]},e(i,"avatar")),(0,o.jsx)(eA,{user:i,classNames:[ew,ex,eO]},e(i,"name")))}else if(2===this.state.fadeOut.length&&!this.state.fadeOut[0]&&this.state.fadeOut[1]){let a=this.state.fadeOut[1];t.push((0,o.jsx)(eA,{user:a,classNames:[ew,ex,eO]},e(a,"name")))}else t.push.apply(t,this.state.fadeOut.map((t,i)=>t&&(0,o.jsx)(eC,{call:a,user:t,classNames:[ey[i],ex]},e(t,"avatar"))));if(1===this.state.active.length){let i=this.state.active[0];t.push((0,o.jsx)(eC,{call:a,user:i,classNames:[ey[0],eb]},e(i,"avatar")),(0,o.jsx)(eA,{user:i,classNames:[ew,eb,eO]},e(i,"name")))}else t.push.apply(t,this.state.active.map((t,i)=>(0,o.jsx)(eC,{call:a,user:t,classNames:[ey[i],eb]},e(t,"avatar"))));return t.sort((e,t)=>null===e.key||null===t.key?0:e.key>t.key?-1:1),setTimeout(()=>{this.node?.querySelectorAll("."+eb).forEach(e=>e.classList.remove(eb))},10),(0,o.jsx)("div",{ref:e=>this.node=e,className:"active_speakers_row--activeSpeakerRow--l5ylB",children:t})}}function eS(e){let{call:t,usersInCall:a}=e,s=(0,c.iZ)(),l=(0,V.mt)(t),n=i.useMemo(()=>l?.filter(e=>e!==s?.id)?.slice(0,6).reduce((e,t)=>{let o=a.find(({userID:e})=>e===t);return o?e.concat([o]):e},[])||[],[l,a,s]);return(0,o.jsx)(ek,{users:n})}var eL=a(364616),eW=a(844411);function eU(e){let{children:t,headerText:a,collapsedContent:s,onToggle:l,collapseStateOverride:n}=e,[c,r]=i.useState(!1),d=n||c;return(0,o.jsxs)("span",{children:[(0,o.jsx)(w.fI,{className:d?"voice_collapsible_dropdown--isCollapsed--SwBvz":"",children:(0,o.jsxs)("span",{className:"voice_collapsible_dropdown--dropdownSectionTitle--lpt22",onClick:t=>{t.preventDefault(),t.stopPropagation(),l&&!0!==e.hideToggleOption&&l(!d),r(!d)},children:[d?s:a,!e.hideToggleOption&&(0,o.jsx)(Y.B,{svg:d?eL.A:eW.A,className:"voice_collapsible_dropdown--voiceDropdownChevronIcon--JgQxE"})]})}),!d&&t&&(0,o.jsx)(o.Fragment,{children:t})]})}var eP=a(560823);function eM(e){let t=(0,s.d4)(e=>e.voice.showWidgetParticipantList),a=(0,c.iZ)(),n=(0,s.wA)(),{userIdsInCall:u}=(0,d.W5)(e.fileKey),p=(0,d.bF)(u,e.fileKey),v=(0,r.eo)(),{usersInCall:h,callMetadata:m}=i.useMemo(()=>({usersInCall:p.filter(e=>e.userID!==a?.id),callMetadata:{microphoneStyle:_.bU.FULL,call:e.call}}),[p,a,e.call]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eN.sK,{}),h.length>0&&(0,o.jsx)("div",{className:eP.ev,children:(0,o.jsx)(eU,{headerText:`${e.currentUserInCall?"You and ":""}`+(0,em.td)(h.length,"person","people")+" in conversation",collapseStateOverride:!t,collapsedContent:(0,o.jsx)(eS,{usersInCall:h,call:e.call}),hideToggleOption:h.length<2,onToggle:e=>n(l.yF(!e)),children:(0,o.jsx)(eE.P,{className:eP.YM,children:h.map(e=>(0,o.jsx)(ef.Q,{callMetadata:m,user:e,isOverflow:!0,onUserClick:v},"sessionID"in e?e.sessionID:e.userID))})})})]})}var e$=a(302727),eG=a(452981),eB=a(234191),eV=a(944730),eH=a(669417);let eF=(0,i.memo)(function(e){return(0,o.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,o.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7 7h10a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1M5 8a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2zm4.5 7a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm4.5-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m-3.5-.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm2.5 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5M7.5 13a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z",clipRule:"evenodd"})})});var ez=a(812714),eJ=a(824570);a(120440);var eX=a(883765),eY=a(983500),eK=a(769109),eq=a(679359),eQ=a(58212),eZ=a(111297),e0=a(215853),e1=a(954741),e5=a(404343);let e2="device_controls--deviceControlRow--kSC19",e4="device_controls--controlLabel--Yp1lV",e7="device_controls--dropdownContainer--DfMXW",e9="device_controls--dropdownInput--w72f-",e6="device_controls--dropdownChevron--UBe58",e3="MICROPHONE_CONTROL_DROPDOWN",e8="PLAYBACK_DEVICE_CONTROL_DROPDOWN",te=(0,eY.jz)(e5.aHA);function tt(e,t,a,o,l,n,c){let r=(0,s.wA)(),[d,_]=(0,i.useState)(null),[u,p]=(0,i.useState)([]),v=(0,s.d4)(e=>e.dropdownShown?.type===o),h=(0,eJ.wm)(()=>u.map(e=>e.deviceId),[u]),f=(0,i.useCallback)(async()=>{try{let e=await t(),a=new Set(h);(h.length!==e.length||e.some(e=>!(e.deviceId in a)))&&p(e)}catch{c||r(eQ.F.enqueue({message:(0,E.t)("collaboration.voice.error_fetching_devices"),error:!0,type:"voice-device-error"}))}},[h,r,t,c]),N=(0,i.useCallback)(async()=>{try{if(n&&!m.Ay.chrome)return;let t=await e();t.deviceId!==d?.deviceId&&_(t)}catch{}},[n,e,d]),I=(0,i.useCallback)(async e=>{e.deviceId!==d?.deviceId&&_(e);try{await a(e)}catch{r(eQ.F.enqueue({message:(0,E.t)("collaboration.voice.error_selecting_device"),error:!0,type:"voice-device-error"})),await N()}},[N,a,r,d]);return(0,i.useEffect)(()=>{(l||v)&&f()},[l,v,f]),(0,i.useEffect)(()=>{N(),f()},[]),[d,u,I]}function ta(e){let[t,a,i]=tt(e.call.currentMicrophone,e.call.getMicrophones,e.call.setMicrophone,e3,e.isOpen,!1,e.microphonePermissionDenied),[s,l,n]=tt(e.call.currentPlaybackDevice,e.call.getPlaybackDevices,e.call.setPlaybackDevice,e3,e.isOpen,!0,e.microphonePermissionDenied),c=e.targetRef.current?.getBoundingClientRect();return e.isOpen?(0,o.jsx)(to,{targetRect:c,currentMicrophone:t,microphoneDevices:a,setMicrophone:i,currentPlaybackDevice:s,playbackDevices:l,setPlaybackDevice:n}):null}function to(e){let{targetRect:t,currentMicrophone:a,microphoneDevices:l,setMicrophone:n,currentPlaybackDevice:c,playbackDevices:r,setPlaybackDevice:d}=e,_=(0,s.wA)(),u=i.useId(),p=i.useId(),[v,h]=(0,i.useState)({type:""}),f=()=>{h({type:""})},N={format:e=>e?.label||"",isEqual:(e,t)=>e.deviceId===t.deviceId},I=(0,ez.kc)().a11y_voice_dropdowns?(0,o.jsx)("span",{className:"x5b7gxt",children:(0,o.jsx)(eV.C,{})}):(0,o.jsx)(eV.C,{}),g=(0,ez.kc)().a11y_voice_dropdowns?(0,o.jsx)("span",{className:"x5b7gxt",children:(0,o.jsx)(eH.W,{})}):(0,o.jsx)(eH.W,{}),O=(0,o.jsx)("span",{className:e7,children:(0,o.jsxs)(e$.Root,{value:a?.label??(0,E.t)("collaboration.voice.microphone_not_found"),onChange:e=>{n(l.find(t=>t.label===e)??{deviceId:"not_found",label:(0,E.t)("collaboration.voice.microphone_not_found"),groupId:"not_found",kind:"audioinput",toJSON:()=>null})},children:[(0,o.jsx)(e$.Trigger,{width:"fill",iconLead:I,label:(0,o.jsx)(eG.h,{children:(0,E.t)("collaboration.voice.microphone")})}),(0,o.jsx)(e$.Container,{children:l.map(e=>(0,o.jsx)(e$.Option,{value:e.label,children:e.label},e.deviceId))})]})}),x=(0,o.jsx)(e1.l6,{ariaLabelledBy:u,chevronClassName:e6,className:e7,dispatch:_,dropdownShown:v,formatter:N,icon:I,id:e3,inputClassName:e9,neverConstrain:!0,onChange:e=>{n(e)},onHideDropdownOverride:f,onShowDropdownOverride:()=>h({type:e3}),property:a||{deviceId:"not_found",label:(0,E.t)("collaboration.voice.microphone_not_found"),groupId:"not_found",kind:"audioinput",toJSON:()=>null},children:l.map(e=>(0,o.jsx)(e1.c$,{value:e,children:e.label},e.deviceId))}),b=(0,o.jsx)("span",{className:e7,children:(0,o.jsxs)(e$.Root,{value:c?.label??(0,E.t)("collaboration.voice.playback_device_not_found"),onChange:e=>{d(r.find(t=>t.label===e)??{deviceId:"not_found",label:(0,E.t)("collaboration.voice.playback_device_not_found"),groupId:"not_found",kind:"audiooutput",toJSON:()=>null})},children:[(0,o.jsx)(e$.Trigger,{width:"fill",iconLead:g,label:(0,o.jsx)(eG.h,{children:(0,E.t)("collaboration.voice.speakers")})}),(0,o.jsx)(e$.Container,{children:r.map(e=>(0,o.jsx)(e$.Option,{value:e.label,children:e.label},e.deviceId))})]})}),j=(0,o.jsx)(e1.l6,{ariaLabelledBy:p,chevronClassName:e6,className:e7,dispatch:_,dropdownShown:v,formatter:N,icon:g,id:e8,inputClassName:e9,neverConstrain:!0,onChange:e=>{d(e)},onHideDropdownOverride:f,onShowDropdownOverride:()=>h({type:e8}),property:c||{deviceId:"not_found",label:(0,E.t)("collaboration.voice.playback_device_not_found"),groupId:"not_found",kind:"audiooutput",toJSON:()=>null},children:r.map(e=>(0,o.jsx)(e1.c$,{value:e,children:e.label},e.deviceId))}),T=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"device_controls--divider--Z8rM-"}),!(0,B.WO)()&&(0,o.jsx)(ts,{}),(0,B.WO)()&&(0,o.jsx)(ti,{})]});return(0,o.jsxs)(e0.Cf,{className:"device_controls--pointingDropdown--hSJ1h",targetRect:t,minWidth:te,propagateCloseClick:!0,lean:"left",leanPadding:52,children:[(0,o.jsxs)("div",{onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"device_controls--header---h3P-",children:[(0,E.t)("collaboration.voice.audio_settings"),(0,o.jsx)(eK.Jn,{onClick:()=>_(P.oB())})]}),(0,o.jsxs)("div",{className:"device_controls--container--VR8KK",children:[(0,o.jsxs)(w.fI,{className:e2,children:[(0,o.jsx)("span",{className:e4,id:u,children:(0,E.tx)("collaboration.voice.microphone")}),(0,ez.kc)().a11y_voice_dropdowns?O:x]}),m.Ay.chrome&&(0,o.jsxs)(w.fI,{className:e2,children:[(0,o.jsx)("span",{className:e4,id:p,children:(0,E.tx)("collaboration.voice.speakers")}),(0,ez.kc)().a11y_voice_dropdowns?b:j]})]})]}),(0,B.X0)()&&T]})}function ti(){let e=(0,s.d4)(e=>e.voice.captionsInstallProgress),t=(0,s.d4)(e=>e.voice.showCaptions),a=(0,s.wA)(),l=i.useId(),n=(0,o.jsx)(eF,{}),c=(0,E.tx)("collaboration.voice.closed_captioning"),r=(0,o.jsx)(X.Ex,{text:(0,E.t)("collaboration.voice.beta"),className:"device_controls--betaTag---VTFI",color:X.zE.BRAND});return t&&(0,B.Mw)(e)&&(c=(0,E.tx)("collaboration.voice.setting_up_closed_captions_install_progress",{installProgress:e}),n=(0,o.jsx)(eq.kt,{className:"device_controls--captionsLoadingSpinner--ivdGQ"}),r=(0,o.jsx)(o.Fragment,{})),(0,o.jsxs)(eG.J,{className:"device_controls--closedCaptionRow--OdIHt raw_components--singleRow--W5dYN raw_components--_singleRow--yTGIY raw_components--singleRowHeight--dKM4t raw_components--_row--rHucX raw_components--row--NThzm device_controls--deviceControlRowWithHover--KUbHL device_controls--deviceControlRow--kSC19",htmlFor:l,children:[n,(0,o.jsxs)("span",{className:"device_controls--captionToggleLabel--MjCYn device_controls--controlLabelFullOpacity--1nEqI device_controls--controlLabel--Yp1lV",children:[c,r]}),(0,o.jsx)(eB.v,{id:l,checked:t,onChange:(e,{event:t})=>{t.stopPropagation(),(0,eX.sx)("voice_captions_toggle",{value:e,source:"voice_widget"}),(0,B.HJ)(a,e)}})]})}function ts(){let e=r.AM.ACCESSIBILITY;return(0,o.jsx)(eZ.L0,{target:"_blank",rel:"noopener",href:e,trackingEventName:"Learn more about captioning",children:(0,o.jsxs)(w.fI,{className:"device_controls--deviceControlRowWithHover--KUbHL device_controls--deviceControlRow--kSC19",children:[(0,o.jsx)(Y.B,{className:"device_controls--iconContainer--TuXUt",svg:et.A}),(0,o.jsx)("span",{className:"device_controls--controlLabelFullOpacity--1nEqI device_controls--controlLabel--Yp1lV",children:(0,E.tx)("collaboration.voice.learn_how_to_turn_on_closed_captioning")})]})})}let tl=(0,L.ck)("94721b53827c353075273e54a45ea41850ee0284"),tn=(0,L.ck)("d917bf9964749c47b46d367572a5dd28a559bd2f"),tc="DEVICE_CONTROL_DROPDOWN",tr=null,td=null,t_=null;function tu(e){let{call:t,fileKey:a,user:n,callEvent:c,notificationUserId:r,callEventCallback:u}=e,p=(0,s.Pj)(),[v,m]=(0,i.useState)(null),[f,N]=(0,i.useState)(),[x,b]=(0,i.useState)(!1),[C,L]=(0,i.useState)(!1),[V,H]=(0,i.useState)(!1),[z,J]=(0,i.useState)(!1),X=(0,s.d4)(e=>e.voice.snapWidget),[Y,K]=(0,i.useState)(!1),[q,Q]=(0,i.useState)(!1),[Z,ee]=(0,i.useState)({}),{userIdsInCall:et}=(0,d.W5)(a);(0,G.W)();let ea=(0,s.d4)(e=>e.voice.showCaptions),eo=(0,s.d4)(e=>e.voice.captionsInstallProgress),ei=(0,s.d4)(e=>e.dropdownShown?.type===tc),es=(0,s.d4)(e=>e.voice.activeCall[a]||!1),ec=(0,s.d4)(e=>e.voice.showWidgetParticipantList),er=(0,i.useRef)(null),ed=(0,s.wA)(),e_={in:()=>{H(!0)},out:()=>(H(!1),new Promise(e=>setTimeout(e,300)))};i.useEffect(()=>{let e=t.getSystemCompatibility();if(m(e),!e){u(_.$E.SYSTEM_INCOMPATIBLE);return}tr||td||(td=new Audio(tl),(tr=new Audio(tn)).load(),td.load(),[td,tr].forEach(e=>e.volume=.5))},[]),i.useEffect(()=>{!es&&v&&eE(),window.requestAnimationFrame(()=>e_.in())},[v]),i.useEffect(()=>{let e;switch(c){case _.$E.DISCONNECTED:q&&(td?.play(),Q(!1)),ed(l.oI({fileKey:a}));break;case _.$E.TOKEN_WILL_EXPIRE_DETECT_MIC_INPUT:(function e(a){if(Date.now()>=a){u(_.$E.TOKEN_WILL_EXPIRE);return}if(t.isLocalUserSpeaking()){eN(!1);return}setTimeout(()=>{e(a)},500)})(Date.now()+1e4);break;case _.$E.CONNECTED:case _.$E.CONNECTED_WITH_MIC_DISABLED:Y&&(setTimeout(()=>tr?.play(),400),K(!1)),ed(l.rO({fileKey:a}));break;case _.$E.CALL_INACTIVE:t.leave();break;case _.$E.TOKEN_WILL_EXPIRE:e=()=>eN(!0);break;case _.$E.TOKEN_EXPIRED:e=eE;break;case _.$E.USER_JOINED:case _.$E.USER_LEFT:if(t_)return;break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:let o=ev(c);if(!o)break;ee({...Z,[c]:o});break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW_RECOVER:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED_RECOVER:let i=function(e){switch(e){case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER:return _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW;case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER:return _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW;case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW_RECOVER:return _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW;case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED_RECOVER:return _.$E.WARNING_RECV_AUDIO_DECODE_FAILED;default:return null}}(c);if(!i)break;delete Z[i],ee(Z)}void 0!==c&&N({callEvent:c,onClick:e,notificationUserId:r})},[c]),i.useEffect(()=>{J(!0)},[X]),i.useEffect(()=>{z&&J(!1)},[z]);let[eu,em]=(0,i.useState)(!0),eE=async()=>{if(em(!0),!t.getSystemCompatibility()){em(!1),u(_.$E.SYSTEM_INCOMPATIBLE);return}b(!0),K(!0),t_=setTimeout(()=>{t_=null},5e3);try{let{data:e}=await U.Ay.post(`/api/voice/${a}/auth`),o=await (0,W.JL)(e.meta.user_encryption_key),i=await (0,W.We)(o,e.meta.call_user_id);if(i!=i)throw Error(`User ID does not match local user ID.
local: ${i}
remote: ${i}`);await t.join({appId:e.meta.app_id,callId:e.meta.call_id,token:e.meta.auth_token,callUserId:e.meta.call_user_id,userId:i,encryptionKey:e.meta.call_encryption_key,userEncryptionKey:o,setParticipantIdsCallback:ef,callEventCallback:u,store:p,fileKey:a})}catch(e){em(!1),u(_.$E.ERROR)}b(!1),em(!1)};function ef(e){ed(l.cb(e))}(0,I.N)({isVisible:V});let eN=async e=>{let{data:o}=await U.Ay.post(`/api/voice/${a}/auth`,{call_user_id:t.uid});await t.renewToken(o.meta.auth_token),e?u(_.$E.CONNECTED):u(_.$E.TOKEN_SILENTLY_RENEWED)},eI=async()=>{b(!0),Q(!0);try{await Promise.all([e_.out(),t.leave()]),ed(l.oI({fileKey:a})),td?.play(),ei&&ed(P.oB()),ed(l.Pp(!1))}catch{e_.in(),u(_.$E.ERROR_ON_LEAVE)}b(!1)},eg=async e=>{(0,$.ds)("voice_user_mute_toggle",a,p.getState(),{source:"voice_widget",muted:!e}),e?await t.unmute():await t.mute()},eO=()=>{ei?ed(P.oB()):((0,$.ds)("voice_widget_open_settings",a,p.getState()),ed(P.j7({type:tc})))},ew=f?f&&et.size>1&&ec?"expanded":"collapsed":null;(0,i.useEffect)(()=>{ea&&(0,B.nN)(eo)&&((0,$.ds)("voice_caption_download_error",a,p.getState(),{error_code:eo,source:"voice_widget"}),(0,B.HJ)(ed,!1),ed((0,M.to)({type:F.L,data:{dispatch:ed,installProgress:eo}})))},[ea,eo,ed,a,p]);let ex=(0,A.U1)();return(0,o.jsx)(O.m,{role:"region",children:(0,o.jsxs)("div",{className:"voice_widget--hybridModalWrapper--x9-GE",ref:ex,children:[(0,o.jsx)("div",{className:h()(j,{[T]:V}),children:(0,o.jsxs)(w.Id,{className:D,children:[(0,o.jsxs)("div",{className:R,children:[(0,o.jsx)("span",{className:es||C?"voice_widget--currentUser--L7Z6l":"voice_widget--inactiveCurrentUser--yVaZY voice_widget--currentUser--L7Z6l",children:(0,o.jsx)(tp,{user:n,call:e.call})}),(0,o.jsx)(ep,{className:"voice_widget--warningIcon--WJPdH",activeWarnings:Z}),(0,o.jsx)(en.Y,{userId:n.id,onMuteButtonClickCallback:eg,disabled:t.microphonePermissionDenied}),(0,o.jsx)(y.d,{"aria-expanded":ei,"aria-label":(0,E.t)("collaboration.voice.settings"),ref:er,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.settings"),onClick:()=>{eO()},htmlAttributes:{onMouseDown:e=>{e.stopPropagation()}},children:(0,o.jsx)(S.n,{})}),(0,o.jsx)(k.E,{className:es||eu?"voice_widget--leaveButton--UUdxH basic_form--btn--FSrmp ellipsis--ellipsis--Tjyfa text--fontPos11--2LvXf text--_fontBase--QdLsd":"voice_widget--joinButton--WvZPr basic_form--btn--FSrmp ellipsis--ellipsis--Tjyfa text--fontPos11--2LvXf text--_fontBase--QdLsd",onClick:es||eu?eI:eE,disabled:!v||x,htmlAttributes:{onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1)},children:es||eu?(0,E.tx)("collaboration.voice.leave"):(0,E.tx)("collaboration.voice.join")})]}),es&&(0,o.jsx)(eM,{fileKey:a,currentUserInCall:es,call:t}),(0,B.WO)()&&ea&&(0,o.jsx)(el,{call:t})]})}),f&&(0,o.jsx)(eh,{notification:f,widgetState:ew}),(0,o.jsx)(ta,{isOpen:ei,call:t,targetRef:er,microphonePermissionDenied:t.microphonePermissionDenied})]})})}function tp({user:e,call:t}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tv,{user:e,call:t}),(0,o.jsx)(H.Ro,{entity:e,size:24,className:"voice_widget--undraggableImage--muN9g",label:e.name})]})}function tv({user:e,call:t}){let a=(0,V.Wl)(e.id,t);return!a||a.isMuted?null:(0,o.jsx)(eg.i,{userId:e.id,userName:e.name,microphoneStyle:_.bU.FULL,className:"voice_widget--avatarVoiceIndicator--zfWwx",volumeIconMutedState:eg.S.NONE,call:t})}function th(){let e=(0,s.d4)(e=>e.mirror.appModel.showUi),t=(0,n.tS)(),a=(0,c.iZ)(),u=(0,s.d4)(e=>e.voice.showWidget),p=(0,s.d4)(e=>t&&t in e.voice.activeCall),v=(0,s.d4)(e=>t&&!!e.voice.activeCall[t]),{userIdsInCall:h}=(0,d.W5)(t,!0),m=(0,d.bF)(h,t).length,E=(0,r.qr)(),f=(0,s.wA)(),[N,I]=(0,i.useState)(),[g,O]=(0,i.useState)(),w=i.useCallback((e,t)=>{_.GA.has(e)&&f(l.Pp(!0)),t&&O(t),I(e)},[f]),x=(0,s.d4)(e=>e.voice.captionsInstallProgress),b=(0,s.d4)(e=>e.voice.showCaptions);return(i.useEffect(()=>{E&&(E.captionsToggleEnabled=b,E.streamAudioForCaptions(b&&100===x))},[b,x,E]),i.useEffect(()=>{u||(O(void 0),I(void 0))},[u]),i.useEffect(()=>{t&&!p&&m>0?f(l.Zq({fileKey:t})):t&&p&&!v&&0===m&&f(l.a6({fileKey:t}))},[m,t,p,v,f]),e&&t&&a)?p&&!u?(0,o.jsx)(C,{fileKey:t}):E&&u?(0,o.jsx)(tu,{fileKey:t,user:a,call:E,notificationUserId:g,callEvent:N,callEventCallback:w}):(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(o.Fragment,{})}}}]);

//# debugId=e19ecdf9-4ac5-57cf-80e7-b2c32abd52c8

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/f695da755526e966524d3a207f8e1d2f4d77a41b/5934-8597055a8113e199.min.js.map