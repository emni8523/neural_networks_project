"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d5e103ee-5db0-5cc7-b455-469f8e4c7407")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[8286],{763636:(e,t,n)=>{n.d(t,{DL:()=>l,DX:()=>r,JM:()=>o,Zg:()=>a,lE:()=>i});let r="editable_typeahead--wrapperBase--nv-jm",l="editable_typeahead--wrapperDefault--KSri0",i="editable_typeahead--mention--wU7Ci",o="editable_typeahead--hyperlink--PZ0V0",a="editable_typeahead--emoji--sNzY6"},442369:(e,t,n)=>{n.d(t,{r:()=>l});var r=n(883765);function l(e,t,n){let l=t.index,i=t.mentions?t.mentions.length:0;(0,r.sx)("at_mention_search_metrics",{did_click_through:n,search_text_length:e.length,selected_index:l,suggestions_length:i})}},705376:(e,t,n)=>{function r(e){let t;let n=0,r=0;-1!==e.lastIndexOf("\n")&&(r=e.lastIndexOf("\n")+1,e=e.substring(r));let l=e.lastIndexOf("@");if(-1!==l){if(t=e.substring(l+1),n=l," "===t.substring(0,1)||t.length>100)return null;let r=e.substring(0,l),i=r.lastIndexOf("@");if(-1!==i){let l=e.substring(i+1);if(-1===l.indexOf(" ")){if(0!==i&&" "!==r[i-1])return null;t=l,n=i}}else if(0!==l&&![" ","[","{","("].includes(e[l-1]))return null}return null!=t?{search:t,index:n+=r}:null}n.d(t,{cJ:()=>i,qm:()=>l,t8:()=>o,uT:()=>r});class l{constructor(){this._isCanceled=!1,this._isEnabled=!0}isCanceled(){return!!this._isEnabled&&this._isCanceled}reset(){this._isEnabled=!1}cancel(){this._isEnabled&&(this._isCanceled=!0)}}class i extends Error{}async function o(e,t){let n=await e;if(t.isCanceled())throw t.reset(),new i;return t.reset(),n}},209097:(e,t,n)=>{n.d(t,{n:()=>r,v:()=>l});let r=/:([0-9A-Za-z-_+]+)$/,l=/(:[0-9A-Za-z-_+]+:)$/},511087:(e,t,n)=>{n.d(t,{AO:()=>f,Ed:()=>c,Ly:()=>u,gG:()=>g});var r=n(291705),l=n(873304),i=n(372868),o=n(750802),a=n(292308),s=n(274748);function f(e,t){let n=e.getCurrentContent();if((0,a.dH)(t))return e;if(t.id.startsWith("invite-")&&!("profile_handle"in t)){let r=n.createEntity("INVITE","IMMUTABLE",{mention:t}).getLastCreatedEntityKey(),l=(0,s.TE)(e);return h(e,l,r,(0,o.F)(t.handle)||"",!1)}let r=n.createEntity("MENTION","IMMUTABLE",{mention:t}).getLastCreatedEntityKey(),l=(0,s.TE)(e),i="profile_handle"in t?`@${t.profile_handle}`:t.handle;return h(e,l,r,(0,o.F)(i)||"",!1)}function g(e,t){let n=l.il.getDefaultSkin(),r=n?`:skin-tone-${n}:`:"";return t.skins.length<2&&(r=""),u(e,`:${t.id}:`+r)}function u(e,t){let n=(0,s.TE)(e),r=(0,i.UF)(t)[0].unicode,l=e.getCurrentContent().createEntity("EMOJI","IMMUTABLE",{text:t,unicode:r}).getLastCreatedEntityKey();return h(e,n,l,r,!1)}function c(e,t){let n=e.getCurrentContent().createEntity("SUGGESTION","IMMUTABLE",{suggestion:t}).getLastCreatedEntityKey(),r=(0,s.TE)(e);return h(e,r,n,t.suggestionInsert,t.suggestionInsert.includes("@"))}let h=(e,t,n,l,i)=>{let o=e.getSelection(),a=e.getCurrentContent(),{start:f,end:g}=t,u=o;null!=f&&null!=g&&(u=o.merge({anchorOffset:f,focusOffset:g}));let c=r.Modifier.replaceText(a,u,l,void 0,n),h=c.getSelectionAfter(),d=c.getLastBlock();d.getKey()===h.getStartKey()&&d.getKey()===h.getEndKey()&&d.getLength()===h.getStartOffset()&&d.getLength()===h.getEndOffset()&&(c=r.Modifier.replaceText(c,h,i?"":" ",void 0,void 0));let y=r.EditorState.push(e,c,"insert-fragment");return i?(0,s.aC)(y,"@"):r.EditorState.forceSelection(y,c.getSelectionAfter())}},274748:(e,t,n)=>{n.d(t,{Aw:()=>$,Bm:()=>T,DL:()=>S,Er:()=>m,FA:()=>N,Gm:()=>C,Ji:()=>v,L5:()=>_,M1:()=>M,Qo:()=>L,TE:()=>I,Wt:()=>D,XM:()=>j,_S:()=>z,aC:()=>K,c9:()=>B,cL:()=>k,d8:()=>w,f7:()=>b,jM:()=>V,lZ:()=>G,mi:()=>O,oP:()=>P,q7:()=>Q,wT:()=>R,ws:()=>X,yN:()=>q});var r=n(291705),l=n(779666),i=n.n(l),o=n(686549),a=n(372868),s=n(750802),f=n(390036),g=n(188154),u=n(666388),c=n(705376),h=n(209097),d=n(782059);let y={BOLD:"b",ITALIC:"i",STRIKETHROUGH:"s"},E={b:"BOLD",i:"ITALIC",s:"STRIKETHROUGH"},p={BOLD:[{char:"*",sequence:"**"},{char:"_",sequence:"__"}],ITALIC:[{char:"*",sequence:"*"},{char:"_",sequence:"_"}],STRIKETHROUGH:[{char:"~",sequence:"~"}]},T=new Set(["*","-","+"]);function k(e,t,n){return A(e,t,n,"EMOJI")}function O(e,t,n){return A(e,t,n,"HYPERLINK")}function S(e,t){let n=e.getText();for(let r of(0,d.Vt)(n).filter(t=>{for(let n=t.start;n<t.end;n++)if(e.getEntityAt(n))return!1;return!0}))t(r.start,r.end)}function m(e,t,n){return A(e,t,n,"MENTION")}function b(e,t,n){return A(e,t,n,"INVITE")}let A=(e,t,n,r)=>{e.findEntityRanges(e=>(function(e,t,n){return null!==t&&e.getEntity(t).getType()===n})(n,e.getEntity(),r),t)};function C(e){let t=e.getSelection(),n=e.getCurrentContent(),r=t.getAnchorKey(),l=n.getBlockForKey(r),i=t.getAnchorOffset(),o=l.getText().substring(0,i),a=(0,c.uT)(o);return null!==a?a.search:""}function K(e,t){let n=e.getCurrentContent().getBlockMap().toArray(),l=null;for(let e of n){let n=e.getText().indexOf(t);if(-1!==n){l={blockKey:e.getKey(),position:n+1};break}}if(l){let t=new r.SelectionState({anchorKey:l.blockKey,anchorOffset:l.position,focusKey:l.blockKey,focusOffset:l.position});return r.EditorState.forceSelection(e,t)}return e}function I(e){let t,n,r,l;let i=e.getSelection(),o=e.getCurrentContent(),f=i.getAnchorKey(),g=o.getBlockForKey(f),d=i.getAnchorOffset(),y=o.getBlocksAsArray(),E=q(e),p=g.getText().substring(0,d),T=p.match(h.n),k=p.match(h.v),O=(0,c.uT)(p);if(O){let e=function(e,t,n,r,l){let{token:i}=function e(t,n){let r=0;for(let l=0;l<n.length;l++){if(n[l].children?.length){let{lengthOfText:i,token:o}=e(t-r,n[l].children);if((r+=i)>t)return{lengthOfText:r,token:o}}else n[l].t?r+=n[l].t?.replace(/\n/g,"").length||0:r+=s.F(n[l].user_annotated?.handle)?.length||0;if((r+="profile_id"in n[l]?1:0)>t)return{lengthOfText:r,token:n[l]}}return{lengthOfText:r,token:null}}(function(e,t,n,r){let l=0;for(let n=0;n<e.length&&e[n]!==t;++n)l+=e[n].getText().replace(/\n/g,"").length;return l+(n-(r.match(/\n/g)||[]).length)}(e,t,n,l),r);return i}(y,g,O.index,E,p);O=e&&(0,u.l5)(e)===u.vj.PLAIN_TEXT?O:null}return O?(t="MENTION",n=O.search,r=O.index,l=d):T?(t="EMOJI",n=T[1],r=T.index,l=d):k&&(0,a.xM)(k[1])&&(t="COMPLETE_EMOJI",n=k[1],r=k.index,l=d),{type:t,search:n,start:r,end:l}}function _(){let e=window.getSelection();if(e&&e.rangeCount>0){let t=e.getRangeAt(0).getBoundingClientRect();return(0,o.E)(t)}return null}function M(e){var t;let n=e.getSelection(),r=null;if((t=n).getStartKey()===t.getEndKey()){let t=w(e),l=[];if(t.findEntityRanges(t=>{let n=t.getEntity();return null!==n&&"HYPERLINK"===e.getCurrentContent().getEntity(n).getType()},(e,t)=>{l.push({start:e,end:t})}),l.length<1)return{selection:n,entityKey:r};let i={start:n.getStartOffset(),end:n.getEndOffset()};for(let o of l)if(i.start>=o.start&&i.end<=o.end){n=v(e,o),r=t.getEntityAt(o.start);break}}return r&&(n=L(e,n,r)),{selection:n,entityKey:r}}function x(e,t,n,r){let l=t.getEntityAt(n);if(!l)return!1;let i=e.getEntity(l);return"HYPERLINK"===i.getType()&&i.getData().hyperlink===r}function L(e,t,n){let r=e.getCurrentContent(),l=r.getEntity(n);if(!l||"HYPERLINK"!==l.getType())return t;let i=l.getData().hyperlink,o=r.getBlockForKey(t.getStartKey()),a=t.getStartOffset(),s=o,f=a-1;e:for(let e=0;e<r.getBlocksAsArray().length&&s;e++){for(;f>=0;f--){if(!x(r,s,f,i))break e;o=s,a=f}s=r.getBlockBefore(s.getKey()),f=(s?.getLength()||0)-1}let g=r.getBlockForKey(t.getEndKey()),u=t.getEndOffset();s=g,f=u+1;e:for(let e=0;e<r.getBlocksAsArray().length&&s;e++){for(;f<=s.getLength();f++){if(!x(r,s,f-1,i))break e;g=s,u=f}s=r.getBlockAfter(s.getKey()),f=1}return t.merge({anchorOffset:a,anchorKey:o.getKey(),focusOffset:u,focusKey:g.getKey()})}function B(e){let t=e.getSelection();return t.getAnchorKey()===t.getFocusKey()&&t.getAnchorOffset()===t.getFocusOffset()}function N(e){let t=e.getCurrentContent();return!t.hasText()&&"unstyled"===t.getBlockMap().first().getType()}function R(e){return!!B(e)&&0===e.getSelection().getStartOffset()}function w(e){let t=e.getSelection().getAnchorKey();return e.getCurrentContent().getBlockForKey(t)}function v(e,t){let n=w(e);return r.SelectionState.createEmpty(n.getKey()).merge({anchorOffset:t.start,focusOffset:t.end})}function F(e,t,n){let l=v(e,t);return r.Modifier.replaceText(e.getCurrentContent(),l,n)}let H=e=>{let{index:t,char:n,line:r,numRepeats:l,exactMatch:i}=e;if(i&&t-l-1>=0&&r.charAt(t-l-1)===n)return!1;for(let e=0;e<l;e++)if(r.charAt(t-e-1)!==n)return!1;return!0},U=(e,t,n)=>{if(n-1>0&&" "===e.charAt(n-1))return null;for(let r=n-1;r>=0;r--){if(" "===e.charAt(r))continue;let l=!1;switch(t){case"BOLD":for(let{char:t,sequence:i}of p.BOLD)e.charAt(r)!==t&&e.charAt(n)===t&&H({index:r,char:t,line:e,numRepeats:i.length,exactMatch:!1})&&(l=!0);break;case"ITALIC":for(let{char:t,sequence:i}of p.ITALIC)if(e.charAt(r)!==t&&e.charAt(n)===t&&H({index:r,char:t,line:e,numRepeats:i.length,exactMatch:!1})){if("_"===t){let t=r-i.length-1;(t<0||" "===e.charAt(t))&&(l=!0)}else l=!0}break;case"STRIKETHROUGH":for(let{char:t,sequence:i}of p.STRIKETHROUGH)e.charAt(r)!==t&&e.charAt(n)===t&&H({index:r,char:t,line:e,numRepeats:i.length,exactMatch:!1})&&(l=!0)}if(l)return{start:r,end:n}}return null};function j(e,t){if(!B(e))return null;let n=e.getSelection(),r=w(e),l=n.getAnchorOffset();if(0===l&&""===t){let t=e.getCurrentContent().getBlockBefore(r.getKey());if(!t)return null;r=t,l=t.getLength()}let i=r.getText();for(let e of Object.keys(p))for(let n of p[e]){let{char:r,sequence:o}=n;if(t!==r&&H({index:l,char:r,line:i,numRepeats:o.length,exactMatch:!0})){let t=U(i,e,l-o.length);if(t)return{sequence:o,style:e,range:t}}}return null}function D(e,t){if(" "!==t||!B(e))return null;let n=e.getSelection(),r=w(e);if(" "===t){let e=i()(r.getText().slice(0,n.getAnchorOffset()));if(T.has(e))return"unordered-list-item";if("1."===e)return"ordered-list-item"}return null}function P(e,t,n){let{sequence:l,style:i,range:o}=n;if(t.length){let n=r.Modifier.insertText(e.getCurrentContent(),v(e,{start:o.end+l.length,end:o.end+l.length}),t);e=r.EditorState.push(e,n,"insert-characters")}let a=r.Modifier.removeRange(e.getCurrentContent(),v(e,{start:o.end,end:o.end+l.length}),"backward");a=r.Modifier.removeRange(a,v(e,{start:o.start-l.length,end:o.start}),"backward");let s={start:o.start-l.length,end:o.end-l.length},f=v(e,s),g=r.Modifier.applyInlineStyle(a,f,i);e=r.EditorState.push(e,g,"change-inline-style");let u={start:s.end+t.length,end:s.end+t.length};return e=r.EditorState.forceSelection(e,v(e,u))}function Q(e,t){let n={start:0,end:e.getSelection().getAnchorOffset()},l=w(e).getText().slice(n.start,n.end),i=F(e,n,`${l} `),o=F(e=r.EditorState.push(e,i,"insert-characters"),{start:n.start,end:n.end+1},""),a={start:0,end:0},s=v(e,a),f=r.Modifier.setBlockType(o,s,t);return e=r.EditorState.push(e,f,"change-block-type"),e=r.EditorState.forceSelection(e,v(e,a))}function q(e){let t,n;let l=[],i="",o=e=>{let t=n||l;e.profile_id||e.user_id||e.user_annotated||e.styles||e.link?t.push(e):""!==e.t&&(t.length&&"t"in t[t.length-1]&&1===Object.keys(t[t.length-1]).length?t[t.length-1].t+=e.t:t.push(e))},a=(e,t,n)=>{let r=g.entityMap[e.key],l={};"MENTION"===r.type&&"profile_handle"in r.data.mention?(l.profile_id=r.data.mention.id,l.t=r.data.mention.profile_handle):"MENTION"===r.type?(l.user_id=r.data.mention.id,l.user_annotated=r.data.mention):"HYPERLINK"===r.type?(l.link=r.data.hyperlink,l.t=t):"EMOJI"===r.type?l.t=r.data.text:"INVITE"===r.type?(l.t=r.data.mention.email,l.user_id=r.data.mention.id):(l.t=t,n.length&&(l.styles=n)),o(l)},g=(0,r.convertToRaw)(e.getCurrentContent()),u="";return g.blocks.forEach(e=>{let r=(0,f.Qt)((0,s.F)(e.text)||"");["ordered-list-item","unordered-list-item"].includes(e.type)?(e.type!==i&&(n&&l.push({styles:["ordered-list-item"===i?"ol":"ul"],children:t}),t=[],n=[]),t||=[],n||=[],i=e.type.slice()):(l.length&&""===i&&o({t:"\n"}),n&&(l.push({styles:["ordered-list-item"===i?"ol":"ul"],children:t}),t=void 0,n=void 0),i="");let g={};e.entityRanges.forEach(e=>{g[e.offset]=e});let c={};(0,d.Vt)(e.text).forEach(e=>{let{start:t,end:n}=e;for(let e=t;e<n;e++)if(g[e])return;c[t]=e});let h={};e.inlineStyleRanges.forEach(e=>{e.offset in h?h[e.offset].push(e):h[e.offset]=[e]});let E=[],p={};for(let e=0;e<r.length;e++){if(e in p&&E.length&&(o({t:u,styles:[...E]}),u="",E=E.filter(t=>!p[e].includes(t))),e in g){let t=g[e];if(E.length)for(var T in o({t:u,styles:[...E]}),E=[],p)Number(T)>e+t.length&&E.push(...p[T]);else o({t:u});u="",a(t,r.slice(e,e+t.length).join(""),E),e+=t.length-1;continue}if(e in c){let t=c[e],n=t.end-t.start;if(E.length)for(var T in o({t:u,styles:[...E]}),E=[],p)Number(T)>e+n&&E.push(...p[T]);else o({t:u});u="",o({t:r.slice(e,e+n).join(""),link:t.href}),e+=n-1;continue}e in h&&(E.length?o({t:u,styles:[...E]}):o({t:u}),u="",h[e].forEach(e=>{if(y[e.style]){let t=y[e.style];E.push(t);let n=e.offset+e.length;n in p?p[n].push(t):p[n]=[t]}})),u+=r[e]}E.length?o({t:u,styles:[...E]}):o({t:u}),u="",n&&(0===n.length&&n.push({t:""}),t.push({children:n}),n=[])}),n&&l.push({styles:["ordered-list-item"===i?"ol":"ul"],children:t}),l}function G(e){let t=[];return e.forEach(e=>{let n=(0,s.F)(e.t);if(n){let r=n.split("\n");1===r.length?t.push(e):r.forEach((n,l)=>{let i=l<r.length-1?`${n}
`:n;void 0!==e.styles?t.push({t:i,styles:e.styles}):t.push({t:i})})}else t.push(e)}),t}let J=(e,t,n,r,l,i="default")=>{let o=[],u=[],c="";G(e).forEach(e=>{let h=(0,s.F)(e.t);if(e.children?.length){""!==c&&(l.push({text:c,entityRanges:o,type:i,depth:0,inlineStyleRanges:u,key:l.length.toString()}),c="",u=[],o=[]);let a=e.styles?.includes("ol")?"ordered-list-item":"unordered-list-item";e.children.forEach(e=>{e.children?.length&&J(e.children,t,n,r,l,a)})}else if(e.user_annotated||e.profile_id){let t=e.user_annotated?(0,s.F)(e.user_annotated.handle)||"":"@"+h,n=e.user_annotated?e.user_annotated:{id:e.profile_id,profile_handle:h};o.push({key:Object.keys(r).length,length:(0,f.Qt)(t).length,offset:(0,f.Qt)(c).length}),r[Object.keys(r).length]={type:"MENTION",mutability:"IMMUTABLE",data:{mention:n}},c+=t}else if(e.link&&(0,d.$x)((0,g.xT)(e.link)))o.push({key:Object.keys(r).length,length:(0,f.Qt)(h).length,offset:(0,f.Qt)(c).length}),r[Object.keys(r).length]={type:"HYPERLINK",mutability:"MUTABLE",data:{hyperlink:e.link,commentEditorType:n}},c+=h;else{if(e.styles?.length)e.styles.forEach(e=>{if(E[e]){let t=E[e];u.push({style:t,length:(0,f.Qt)(h).length,offset:(0,f.Qt)(c).length})}});else if((0,a.Lg)(h)){let e=(0,a.wd)(h),t=0,n="";for(let l of e){let e="",i="";(0,a.xM)(l)&&((0,a.UF)(l).forEach(t=>{e+=t.unicode,i+=t.meta}),o.push({key:Object.keys(r).length,length:(0,f.Qt)(e).length,offset:(0,f.Qt)(c).length+t}),r[Object.keys(r).length]={type:"EMOJI",mutability:"IMMUTABLE",data:{text:i,unicode:e}}),n+=e.length?e:l,t+=(0,f.Qt)(e.length?e:l).length}h=n}h?.endsWith("\n")?(c+=h.slice(0,-1),l.push({text:c,entityRanges:o,type:i,depth:0,inlineStyleRanges:u,key:l.length.toString()}),c="",o=[],u=[]):c+=h}}),(""!==c||"default"!==i)&&l.push({text:c,entityRanges:o,type:i,depth:0,inlineStyleRanges:u,key:l.length.toString()})};function $(e,t,n){let l={},i=[];J(e,t,n,l,i,"default");let o=(0,r.convertFromRaw)({blocks:i,entityMap:l});return r.EditorState.createWithContent(o,t)}let Y=e=>{let t=e.getCurrentContent().getFirstBlock(),n=t.getKey(),l=t.getLength();return r.EditorState.acceptSelection(e,new r.SelectionState({anchorKey:n,anchorOffset:l,focusKey:n,focusOffset:l,isBackward:!1}))};function V(e){let t=Y(e);return r.EditorState.forceSelection(t,t.getSelection())}let Z=e=>{let t=e.getAttribute("data-mention-user-id"),n=e.getAttribute("data-tooltip-user-handle");return t&&n?{id:t,handle:n}:null},W=e=>e.getAttribute("data-tooltip-url-string");function z(e,t){var n=new DOMParser().parseFromString(e,"text/html"),l=n.getElementsByTagName("a");let i={};for(let e=0;e<l.length;e++){l[e].setAttribute("href",new URL(l[e].href,document.baseURI).toString());let t=l[e].getAttribute("href"),n=Z(l[e]);n&&t&&(i[t]=n);let r=W(l[e]);r&&l[e].setAttribute("href",r)}n.querySelectorAll('[data-stringify-type="paragraph-break"]').forEach(function(e){let t=n.createElement("br");e.parentNode&&e.parentNode.replaceChild(t,e)});let o=n.querySelector("body"),a=o?o.innerHTML:n.documentElement.outerHTML,s=a.includes("\x3c!--StartFragment--\x3e")?a:a.replace(/(?:\r\n|\r|\n)/g,"<br/>"),f=(0,r.convertFromHTML)(s),u=r.ContentState.createFromBlockArray(f.contentBlocks,f.entityMap);return u.getBlockMap().forEach(e=>{e?.findEntityRanges(e=>{let t=e.getEntity();return!!t&&"LINK"===u.getEntity(t).getType()},(n,l)=>{let o=e.getText().slice(n,l),a=r.SelectionState.createEmpty(e.getKey());a=a.merge({anchorOffset:n,focusKey:e.getKey(),focusOffset:l});let s=e.getEntityAt(n),f=u.getEntity(s).getData().url,c=i[f];c&&c.handle===o?u=u.createEntity("MENTION","IMMUTABLE",{mention:i[f]}):d.$x(g.xT(f))&&(u=u.createEntity("HYPERLINK","MUTABLE",{hyperlink:f,editorType:t}));let h=u.getLastCreatedEntityKey();u=r.Modifier.applyEntity(u,a,h)})}),u}function X(e){let t=e.getCurrentContent().getLastBlock().getKey(),n=e.getSelection().getEndKey();return n===t||n===e.getCurrentContent().getKeyBefore(t)}}}]);

//# debugId=d5e103ee-5db0-5cc7-b455-469f8e4c7407

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/03a7b79bb316f1fa37824042940f38a2f12f19ba/8286-2371b1be18bde555.min.js.map